<!DOCTYPE html><html lang="ja"><head><meta charSet="utf-8"/><title>Cloudflare Workers で使えるグローバル変数を一覧する - アルパカの徒然文</title><meta name="description" content="Cloudflare Workers で使えるグローバル変数を一覧する方法を紹介しました"/><link rel="canonical" href="https://codehex.dev/note/cloudflare_workers_global"/><meta name="twitter:card" content="summary_large_image"/><meta name="twitter:site" content="@codehex"/><meta property="og:url" content="https://codehex.dev/note/cloudflare_workers_global"/><meta property="og:title" content="Cloudflare Workers で使えるグローバル変数を一覧する - アルパカの徒然文"/><meta property="og:image" content="https://codehex.dev/assets/images/7730917f14e4a4c33b1eff3f55941ed9.png"/><meta property="og:description" content="Cloudflare Workers で使えるグローバル変数を一覧する方法を紹介しました"/><meta property="og:type" content="article"/><meta name="viewport" content="width=device-width, initial-scale=1"/><meta name="next-head-count" content="12"/><script async="" src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-8097329174824434" crossorigin="anonymous"></script><link rel="preload" href="/_next/static/css/1386383271a5d05d.css" as="style"/><link rel="stylesheet" href="/_next/static/css/1386383271a5d05d.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-5cd94c89d3acac5f.js"></script><script src="/_next/static/chunks/webpack-e7f9a8f407d6abab.js" defer=""></script><script src="/_next/static/chunks/framework-bb5c596eafb42b22.js" defer=""></script><script src="/_next/static/chunks/main-5b1095b7dd901b1a.js" defer=""></script><script src="/_next/static/chunks/pages/_app-a21fb48766517705.js" defer=""></script><script src="/_next/static/chunks/186-52595008a9b3875f.js" defer=""></script><script src="/_next/static/chunks/55-818e347ebc0aa2d2.js" defer=""></script><script src="/_next/static/chunks/463-c79017b7d878f8c9.js" defer=""></script><script src="/_next/static/chunks/pages/note/cloudflare_workers_global-27844243a55950ea.js" defer=""></script><script src="/_next/static/1789b1769d6a4944e6c6328f26925e21485d6dfa/_buildManifest.js" defer=""></script><script src="/_next/static/1789b1769d6a4944e6c6328f26925e21485d6dfa/_ssgManifest.js" defer=""></script><script src="/_next/static/1789b1769d6a4944e6c6328f26925e21485d6dfa/_middlewareManifest.js" defer=""></script></head><body><div id="__next" data-reactroot=""><main role="main" class="w-full mx-auto max-w-3xl xl:max-w-5xl"><div class="w-full bg-white antialiased"><div class="mx-8 sm:mx-10 md:mx-12 pt-10 pb-16"><div class="pb-2 border-b border-gray-200 mb-10"><h1 class="inline-block text-3xl font-bold text-gray-900 tracking-tight">Cloudflare Workers で使えるグローバル変数を一覧する</h1><div class="text-sm sm:text-base whitespace-nowrap text-gray-500"><div class="sr-only">Published on</div><time dateTime="2022-07-06T20:47:34+09:00">July 06, 2022<!-- --> (<!-- -->29 minutes ago<!-- -->)</time></div><div aria-label="タグ一覧" class="flex flex-wrap gap-2"><a role="link" class="w-max inline-flex rounded-sm bg-blue-100 hover:bg-blue-600 px-2 py-0.5 text-sm" href="/note/tags/cloudflare/"><span class="font-medium text-blue-700 hover:text-white"># <!-- -->cloudflare</span></a><a role="link" class="w-max inline-flex rounded-sm bg-blue-100 hover:bg-blue-600 px-2 py-0.5 text-sm" href="/note/tags/typescript/"><span class="font-medium text-blue-700 hover:text-white"># <!-- -->typescript</span></a></div></div><article role="article" class="prose sm:prose-sm md:prose-md"><p>Cloudflare Workers では <strong>Module Worker Syntax</strong> と <strong>Service Worker Syntax</strong> の２つの記述方式が存在している。
Service Worker Syntax を利用している場合、環境変数はすべてグローバル変数として利用可能になる。たまにデバッグ目的とかで使える便利な技である。</p>
<pre><code class="language-ts">addEventListener(&#x27;fetch&#x27;, (event: FetchEvent) =&gt; {
  // @ts-ignore
  console.log({ ...global })
  event.respondWith(new Response(&quot;Hello, World!!&quot;))
})
</code></pre>
<p>コードを読んで分かる通り、グローバルで扱えるものすべて <code>global</code> 変数に格納されている。これは <code>@cloudflare/workers-types</code> にも定義されていないため <code>@ts-ignore</code> する必要がある。</p>
<p>実行した結果はこんな感じになる。</p>
<p><a href="https://gist.github.com/Code-Hex/5eb472e1f1df34cbc68e8bbf89a30adb">https://gist.github.com/Code-Hex/5eb472e1f1df34cbc68e8bbf89a30adb</a></p>
<pre><code>{
  global: ServiceWorkerGlobalScope {},
  self: ServiceWorkerGlobalScope {},
  addEventListener: [Function: addEventListener],
  removeEventListener: [Function: removeEventListener],
  dispatchEvent: [Function: dispatchEvent],
  console: Object [console] {
    log: [Function: log],
    warn: [Function: warn],
    dir: [Function: dir],
    time: [Function: time],
    timeEnd: [Function: timeEnd],
    timeLog: [Function: timeLog],
    trace: [Function: trace],
    assert: [Function: assert],
    clear: [Function: clear],
    count: [Function: count],
    countReset: [Function: countReset],
    group: [Function: group],
    groupEnd: [Function: groupEnd],
    table: [Function: table],
    debug: [Function: debug],
    info: [Function: info],
    dirxml: [Function: dirxml],
    error: [Function: error],
    groupCollapsed: [Function: groupCollapsed],
    Console: [Function: Console],
    profile: [Function: profile],
    profileEnd: [Function: profileEnd],
    timeStamp: [Function: timeStamp],
    context: [Function: context]
  },
  setTimeout: [Function (anonymous)],
  setInterval: [Function (anonymous)],
  clearTimeout: [Function: clearTimeout],
  clearInterval: [Function: clearInterval],
  queueMicrotask: [Function: queueMicrotask],
  scheduler: Scheduler {},
  atob: [Function: atob],
  btoa: [Function: btoa],
  Math: Object [Math] {},
  crypto: Crypto {},
  CryptoKey: [Function: bound CryptoKey],
  TextDecoder: [class TextDecoder],
  TextEncoder: [class TextEncoder],
  fetch: [AsyncFunction: fetch],
  Headers: [class Headers],
  Request: [class Request extends Body],
  Response: [class Response extends Body],
  FormData: [class FormData] { name: &#x27;FormData&#x27; },
  Blob: [class Blob],
  File: [class File extends Blob],
  URL: [class URL],
  URLSearchParams: [class URLSearchParams],
  URLPattern: [class URLPattern],
  ByteLengthQueuingStrategy: [class ByteLengthQueuingStrategy],
  CountQueuingStrategy: [class CountQueuingStrategy],
  ReadableByteStreamController: [class ReadableByteStreamController],
  ReadableStream: [class ReadableStream],
  ReadableStreamBYOBReader: [class ReadableStreamBYOBReader],
  ReadableStreamBYOBRequest: [class ReadableStreamBYOBRequest],
  ReadableStreamDefaultController: [class ReadableStreamDefaultController],
  ReadableStreamDefaultReader: [class ReadableStreamDefaultReader],
  TransformStream: [class TransformStream],
  TransformStreamDefaultController: [class TransformStreamDefaultController],
  WritableStream: [class WritableStream],
  WritableStreamDefaultController: [class WritableStreamDefaultController],
  WritableStreamDefaultWriter: [class WritableStreamDefaultWriter],
  FixedLengthStream: [class FixedLengthStream extends TransformStream],
  Event: [class Event] {
    NONE: 0,
    CAPTURING_PHASE: 1,
    AT_TARGET: 2,
    BUBBLING_PHASE: 3
  },
  EventTarget: [class EventTarget] { [Symbol(nodejs.event_target)]: true },
  AbortController: [class AbortController],
  AbortSignal: [class AbortSignal extends EventTarget],
  FetchEvent: [class FetchEvent extends Event],
  ScheduledEvent: [class ScheduledEvent extends Event],
  DOMException: [class DOMException2 extends Error] {
    INDEX_SIZE_ERR: 1,
    DOMSTRING_SIZE_ERR: 2,
    HIERARCHY_REQUEST_ERR: 3,
    WRONG_DOCUMENT_ERR: 4,
    INVALID_CHARACTER_ERR: 5,
    NO_DATA_ALLOWED_ERR: 6,
    NO_MODIFICATION_ALLOWED_ERR: 7,
    NOT_FOUND_ERR: 8,
    NOT_SUPPORTED_ERR: 9,
    INUSE_ATTRIBUTE_ERR: 10,
    INVALID_STATE_ERR: 11,
    SYNTAX_ERR: 12,
    INVALID_MODIFICATION_ERR: 13,
    NAMESPACE_ERR: 14,
    INVALID_ACCESS_ERR: 15,
    VALIDATION_ERR: 16,
    TYPE_MISMATCH_ERR: 17,
    SECURITY_ERR: 18,
    NETWORK_ERR: 19,
    ABORT_ERR: 20,
    URL_MISMATCH_ERR: 21,
    QUOTA_EXCEEDED_ERR: 22,
    TIMEOUT_ERR: 23,
    INVALID_NODE_TYPE_ERR: 24,
    DATA_CLONE_ERR: 25
  },
  WorkerGlobalScope: [class WorkerGlobalScope extends ThrowingEventTarget],
  structuredClone: [Function: structuredClone],
  ArrayBuffer: [Function: ArrayBuffer],
  Atomics: Object [Atomics] {},
  BigInt64Array: [Function: BigInt64Array],
  BigUint64Array: [Function: BigUint64Array],
  DataView: [Function: DataView],
  Date: [Function: Date],
  Float32Array: [Function: Float32Array],
  Float64Array: [Function: Float64Array],
  Int8Array: [Function: Int8Array],
  Int16Array: [Function: Int16Array],
  Int32Array: [Function: Int32Array],
  Map: [Function: Map],
  Set: [Function: Set],
  SharedArrayBuffer: [Function: SharedArrayBuffer],
  Uint8Array: [Function: Uint8Array],
  Uint8ClampedArray: [Function: Uint8ClampedArray],
  Uint16Array: [Function: Uint16Array],
  Uint32Array: [Function: Uint32Array],
  WeakMap: [Function: WeakMap],
  WeakSet: [Function: WeakSet],
  WebAssembly: Object [WebAssembly] {
    compile: [Function: compile],
    validate: [Function: validate],
    instantiate: [Function: instantiate],
    compileStreaming: [Function: compileStreaming],
    instantiateStreaming: [Function: instantiateStreaming]
  },
  MINIFLARE: true,
  caches: CacheStorage {},
  HTMLRewriter: [class HTMLRewriter],
  MessageEvent: [class MessageEvent extends Event],
  CloseEvent: [class CloseEvent extends Event],
  WebSocketPair: [Function: WebSocketPair],
  WebSocket: [class WebSocket extends InputGatedEventTarget],
  PROJECT_ID: &#x27;example-project12345&#x27;,
  kv_namespaces: [ { binding: &#x27;KV&#x27;, id: &#x27;&#x27;, preview_id: &#x27;&#x27; } ],
  tsconfig: &#x27;./tsconfig.json&#x27;
}
</code></pre></article><div aria-label="SNSで共有する" class="flex space-x-2 mt-8"><a href="https://b.hatena.ne.jp/entry/s/codehex.dev/note/cloudflare_workers_global" class="w-16 max-h-6 rounded-sm border border-blue-400" target="_blank" rel="noopener noreferrer" role="link" aria-label="Hatena Bookmarkで共有する"><div class="w-full flex justify-between items-center"><span class="bg-blue-400 hover:bg-blue-500 text-white text-sm font-bold py-px px-1">B!</span><span class="w-full text-center text-gray-600 text-sm hover:bg-blue-100 hover:bg-opacity-50">0</span></div></a><a href="https://twitter.com/intent/tweet?text=Cloudflare%20Workers%20%E3%81%A7%E4%BD%BF%E3%81%88%E3%82%8B%E3%82%B0%E3%83%AD%E3%83%BC%E3%83%90%E3%83%AB%E5%A4%89%E6%95%B0%E3%82%92%E4%B8%80%E8%A6%A7%E3%81%99%E3%82%8B&amp;url=https://codehex.dev/note/cloudflare_workers_global" class="flex items-center w-20 rounded-sm bg-blue-400 hover:bg-blue-500" target="_blank" rel="noopener noreferrer" role="link" aria-label="Twitterで共有する"><div class="px-2 w-full flex justify-between items-center"><svg version="1.1" id="Logo" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" class="w-4 h-4" viewBox="0 0 248 204" xml:space="preserve"><g id="Logo_1_"><path id="white_background" fill="#fff" d="M221.95,51.29c0.15,2.17,0.15,4.34,0.15,6.53c0,66.73-50.8,143.69-143.69,143.69v-0.04 C50.97,201.51,24.1,193.65,1,178.83c3.99,0.48,8,0.72,12.02,0.73c22.74,0.02,44.83-7.61,62.72-21.66 c-21.61-0.41-40.56-14.5-47.18-35.07c7.57,1.46,15.37,1.16,22.8-0.87C27.8,117.2,10.85,96.5,10.85,72.46c0-0.22,0-0.43,0-0.64 c7.02,3.91,14.88,6.08,22.92,6.32C11.58,63.31,4.74,33.79,18.14,10.71c25.64,31.55,63.47,50.73,104.08,52.76 c-4.07-17.54,1.49-35.92,14.61-48.25c20.34-19.12,52.33-18.14,71.45,2.19c11.31-2.23,22.15-6.38,32.07-12.26 c-3.77,11.69-11.66,21.62-22.2,27.93c10.01-1.18,19.79-3.86,29-7.95C240.37,35.29,231.83,44.14,221.95,51.29z"></path></g></svg><span class="text-white text-xs font-bold py-px px-1">Tweet</span></div></a></div></div></div></main><footer role="contentinfo" class="w-full mx-auto max-w-3xl xl:max-w-5xl"><div class="text-md font-medium leading-5 divide-y divide-gray-200"><div class="mx-8 sm:mx-10 md:mx-12 pb-24 lg:pb-16"><a role="link" class="text-teal-600 hover:text-teal-700" href="/note/">← Back to the note</a></div></div></footer></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"ogpPath":"/assets/images/7730917f14e4a4c33b1eff3f55941ed9.png","bookmarkCount":"0"},"__N_SSG":true},"page":"/note/cloudflare_workers_global","query":{},"buildId":"1789b1769d6a4944e6c6328f26925e21485d6dfa","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>